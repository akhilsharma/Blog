@model BlogWebsite.Models.ViewModel

@{
    ViewBag.Title = "Details";
}

<h1>@Model.post.Title</h1>
<div style="margin-top: 50px">
    <div class="row">
        <div class="col-md-8">
            <img src="~/image/tag.png" height="30" width="30" />
            @foreach (var item in Model.post.Tags)
            {
                <label>@item.Name |</label>
            }
        </div>
        <div class="col-md-4">
            <label>@Model.post.Date</label>
        </div>
    </div>
    <div class="row" style="margin-top: 50px">
        <div class="col-md-12"><p style="font-size:large">@Model.post.Text</p></div>
    </div>
    <div class="row" style="margin-top: 50px">
        <div class="col-md-6">
            <label>By : @Model.post.Author</label>
        </div>
        <div class="col-md-6">
            <p style="text-align:right"><a href="~/Posts/Index" class="btn btn-primary btn-lg">Back &raquo;</a></p>
        </div>
    </div>
</div>
@if (Context.User.Identity.IsAuthenticated)
{
    if (Model.comment.Count != 0)
    {
        <div>
            <h3>Comments</h3>
            <hr />


            @foreach (var i in Model.comment.Where(x => x.ParentID == 0))
            {
                <div class="container">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <dl>
                                <dd style="padding-top:5px">
                                    @i.Name:
                                    @i.Comments
                                </dd>
                            </dl>
                            @foreach (var m in Model.comment.Where(x => x.ParentID == i.ID))
                            {
                                <dl class="dl-horizontal" style="padding-top:5px">

                                    <dd style="padding-top:5px">
                                        @User.Identity.Name:
                                        @m.Comments
                                    </dd>
                                </dl>
                            }

                            <dl>
                                <dt style="padding-top:2px;margin-left:100px">
                                    <a href="#" class="Reply">Reply</a>
                                </dt>
                            </dl>

                            <div class="ReplyForm" style="display:none">
                                <div class="panel panel-info">
                                    <div class="panel-heading">
                                        <label>Reply To This Comment</label><br />
                                        <form action="~/Posts/ReplyComment" method="post" class="form-horizontal">

                                            <label class="control-label col-sm-2">@User.Identity.Name</label>

                                            <div class="form-group">
                                                <input type="text" class="form-control" id="comment" placeholder="Enter Reply" name="comment">

                                            </div>

                                            <div class="form-group">
                                                <div class="col-sm-offset-2 col-sm-10">
                                                    <input type="hidden" name="Id" value="@i.Post.ID" />
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <div class="col-sm-offset-2 col-sm-10">
                                                    <input type="hidden" name="ParentID" value="@i.ID" />
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <div class="col-sm-offset-2 col-sm-10">
                                                    <button type="submit" class="btn btn-success">Post Comment</button>
                                                </div>
                                            </div>

                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            }



        </div>



    }

    <div class="container">
        <div class="panel panel-info">
            <div class="panel-heading">
                <label>Post Comment</label><br />
                <form action="~/Posts/Comment" method="post" class="form-horizontal">
                    <div class="form-group">
                        <label class="control-label col-sm-2">@User.Identity.Name</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="comment" placeholder="Enter comment" name="comment">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <input type="hidden" name="Id" value="@Model.post.ID" />
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <button type="submit" class="btn btn-success">Post Comment</button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="~/Scripts/jquery-1.10.2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.Reply').click(function (e) {
                e.preventDefault();
                $('.ReplyForm').toggle();
            });
        });
    </script>


}




